window.onload=function(){function c(d,a){d.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))||(d.className+=" "+a)}function b(a,b){a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," "))}function r(d){for(var b in d)c(a[b],d[b]),a[b].firstElementChild.setAttribute("data-state",g[b])}function y(){for(var a,b,c=0;5>c;)b=Math.floor(4*Math.random()),a=m[c],m[c]=m[b],m[b]=a,c++;r(m);return m}function z(){1===Math.floor(2*Math.random())?
(g=["badguy","badguy","badguy","badguy","hero"],q=4):(g=["badguy","badguy","badguy","hero","hero"],q=3);for(var a=g.length,b,c;0!==a;)c=Math.floor(Math.random()*a),--a,b=g[a],g[a]=g[c],g[c]=b;r(g);return g}function G(){for(var b=0;5>b;b++)c(a[b],"close"),a[b].firstElementChild.setAttribute("data-state","");window.setTimeout(function(){for(var b=0;5>b;b++)a[b].className="",c(a[b],"close"),c(a[b],"mask"+(b+1))},300)}function H(){l++;t.innerHTML=e;if(l==q){f+=.1;for(var d=l=0;4>d;)c(a[d],"target"),d++;
window.setTimeout(function(){c(a[0],"close");c(a[1],"close");c(a[2],"close");c(a[3],"close");c(a[4],"close");b(a[0],"shoot");b(a[1],"shoot");b(a[2],"shoot");b(a[3],"shoot");b(a[4],"shoot");for(var d=0;5>d;d++){b(a[d],"badguy");b(a[d],"hero");for(var e=1;6>e;e++)b(a[d],"mask"+e)}z()},300);window.setTimeout(y,400);window.setTimeout(function(){b(a[0],"target");b(a[1],"target");b(a[2],"target");b(a[3],"target");b(a[4],"target");b(a[0],"close");b(a[1],"close");b(a[2],"close");b(a[3],"close");b(a[4],"close")},
500)}else l<q&&(f+=.1)}function n(){clearInterval(A);c(B,"on");h.disabled=!1;k=u.disabled=!1;l=0;G();r();f=15;C.value=f;t.innerHTML=0}function I(){A=setInterval(function(){if(0>=f){n();if(1501>=e)c(v,"on");else if(1501<e){c(w,"on");D.innerHTML=p;E.innerHTML=e;RankView.setUserInfo(p,e);var a=RankView.sortRank();RankView.viewRank(a)}f=15;e=0;h.innerHTML="start";k=!1}else f-=.05,e+=5,t.innerHTML=e,C.value=f,J.style.width=Math.floor(f/15*100)+"%"},50)}var g,m=["mask1","mask2","mask3","mask4","mask5"],
K=document.getElementById("uidbtn"),L=document.getElementById("uid"),F=document.getElementById("intro");document.getElementById("game").getElementsByTagName("progress");var h=document.getElementById("startBtn"),M=document.getElementById("home"),N=document.querySelectorAll("#fail a"),O=document.querySelectorAll("#result a"),C=document.getElementById("progress"),J=document.getElementById("prog_span"),u=document.getElementById("btnResult"),w=document.getElementById("result");document.getElementById("reset");
var a=document.querySelectorAll('[data-type="card"]'),P=document.getElementById("gameId"),v=document.getElementById("fail");document.getElementById("tA");document.getElementById("tB");var t=document.getElementById("tC");document.getElementsByClassName("t2");var D=document.getElementById("result_id"),E=document.getElementById("result_score");document.getElementById("result_ranking");var B=document.getElementById("guide"),e=0,f=15,p=0,k=!1,q=0,l=0,A="engine";h.addEventListener("click",function(){if(0==
k){f=15;e=0;b(B,"on");u.disabled=!0;for(var d=0;5>d;d++)b(a[d],"close"),b(a[d],"mask"+(d+1)),b(a[d],"badguy"),a[d].disabled=!1;z();y();I();h.innerHTML="stop";k=!0}else 1==k&&(n(),h.innerHTML="start",k=!1,e=0)});u.addEventListener("click",function(){c(w,"on");n();k=!1;l=0;h.innerHTML="start";D.innerHTML=p;E.innerHTML=e;RankView.setUserInfo(p,e);var a=RankView.sortRank();RankView.viewRank(a)});for(var Q=null!==document.ontouchstart?"click":"touchstart",x=0;5>x;x++)a[x].addEventListener(Q,function(b){var e=
this.firstElementChild.getAttribute("data-index"),f=this.firstElementChild.getAttribute("data-state");"badguy"==f?(this.firstElementChild.setAttribute("data-state",""),c(a[e],"target"),c(a[e],"shoot"),H()):"hero"==f&&(n(),h.innerHTML="start",c(v,"on"),k=!1,l=0);b.preventDefault();return!1});K.addEventListener("click",function(){var a=L.value;a.match(/[A-Za-z\u3131-\u314e|\u314f-\u3163|\uac00-\ud7a3|0-9]{4,8}/)?(b(F,"on"),p=P.innerHTML=a):window.alert("\ud55c\uae00 \ub610\ub294 \uc601\ubb38 \ub300/\uc18c\ubb38\uc790 4~8\uae00\uc790\ub9cc \uc0ac\uc6a9\uac00\ub2a5\ud569\ub2c8\ub2e4.");
return!1},!1);M.addEventListener("click",function(){n();h.innerHTML="start";c(F,"on");b(a[0],"close");b(a[1],"close");b(a[2],"close");b(a[3],"close");b(a[4],"close");event.preventDefault();return!1});N[0].addEventListener("click",function(){n();h.innerHTML="start";k=!1;b(v,"on");event.preventDefault();return!1});O[0].addEventListener("click",function(){b(w,"on");event.preventDefault();return!1})};